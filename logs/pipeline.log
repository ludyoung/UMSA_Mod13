[2025-11-26T20:10:29.641323Z] ======================================= INICIO PIPELINE =================================
[2025-11-26T20:10:30.922238Z] Tablas cargadas exitosamente: {'customers': 99441, 'geolocation': 1000163, 'order_items': 112650, 'payments': 103886, 'reviews': 99224, 'orders': 99441, 'products': 32951, 'sellers': 3095, 'category_translation': 71}
[2025-11-26T20:10:30.922238Z] ======================================= LIMPIEZA =================================
[2025-11-26T20:10:30.923221Z] === INICIO Limpieza de tablas ===
[2025-11-26T20:10:30.923221Z] Limpieza iniciada para customers, shape original: (99441, 5)
[2025-11-26T20:10:30.958182Z] customers: duplicados eliminados, 99441 filas restantes
[2025-11-26T20:10:31.002844Z] customers: columnas de texto normalizadas -> ['customer_id', 'customer_unique_id', 'customer_city', 'customer_state']
[2025-11-26T20:10:31.021980Z] customers: nulos tratados para todas las columnas
[2025-11-26T20:10:31.021980Z] Limpieza completada para customers, shape final: (99441, 5)
[2025-11-26T20:10:31.022981Z] Limpieza iniciada para geolocation, shape original: (1000163, 5)
[2025-11-26T20:10:31.260205Z] geolocation: duplicados eliminados, 738332 filas restantes
[2025-11-26T20:10:31.391609Z] geolocation: columnas de texto normalizadas -> ['geolocation_city', 'geolocation_state']
[2025-11-26T20:10:31.478816Z] geolocation: nulos tratados para todas las columnas
[2025-11-26T20:10:31.478816Z] Limpieza completada para geolocation, shape final: (738332, 5)
[2025-11-26T20:10:31.479811Z] Limpieza iniciada para order_items, shape original: (112650, 7)
[2025-11-26T20:10:31.537248Z] order_items: duplicados eliminados, 112650 filas restantes
[2025-11-26T20:10:31.589339Z] order_items: columnas de texto normalizadas -> ['order_id', 'product_id', 'seller_id', 'shipping_limit_date']
[2025-11-26T20:10:31.621223Z] order_items: columnas de fecha convertidas -> ['shipping_limit_date']
[2025-11-26T20:10:31.642934Z] order_items: nulos tratados para todas las columnas
[2025-11-26T20:10:31.643932Z] Limpieza completada para order_items, shape final: (112650, 7)
[2025-11-26T20:10:31.643932Z] Limpieza iniciada para payments, shape original: (103886, 5)
[2025-11-26T20:10:31.668039Z] payments: duplicados eliminados, 103886 filas restantes
[2025-11-26T20:10:31.690648Z] payments: columnas de texto normalizadas -> ['order_id', 'payment_type']
[2025-11-26T20:10:31.703196Z] payments: nulos tratados para todas las columnas
[2025-11-26T20:10:31.703196Z] Limpieza completada para payments, shape final: (103886, 5)
[2025-11-26T20:10:31.703196Z] Limpieza iniciada para reviews, shape original: (99224, 7)
[2025-11-26T20:10:31.754897Z] reviews: duplicados eliminados, 99224 filas restantes
[2025-11-26T20:10:31.835214Z] reviews: columnas de texto normalizadas -> ['review_id', 'order_id', 'review_comment_title', 'review_comment_message', 'review_creation_date', 'review_answer_timestamp']
[2025-11-26T20:10:31.867829Z] reviews: columnas de fecha convertidas -> ['review_creation_date', 'review_answer_timestamp']
[2025-11-26T20:10:31.888895Z] reviews: nulos tratados para todas las columnas
[2025-11-26T20:10:31.889880Z] Limpieza completada para reviews, shape final: (99224, 7)
[2025-11-26T20:10:31.889880Z] Limpieza iniciada para orders, shape original: (99441, 8)
[2025-11-26T20:10:31.989789Z] orders: duplicados eliminados, 99441 filas restantes
[2025-11-26T20:10:32.083866Z] orders: columnas de texto normalizadas -> ['order_id', 'customer_id', 'order_status', 'order_purchase_timestamp', 'order_approved_at', 'order_delivered_carrier_date', 'order_delivered_customer_date', 'order_estimated_delivery_date']
[2025-11-26T20:10:32.157960Z] orders: columnas de fecha convertidas -> ['order_purchase_timestamp', 'order_delivered_carrier_date', 'order_delivered_customer_date', 'order_estimated_delivery_date']
[2025-11-26T20:10:32.297298Z] orders: nulos tratados para todas las columnas
[2025-11-26T20:10:32.297298Z] Limpieza completada para orders, shape final: (99441, 8)
[2025-11-26T20:10:32.297298Z] Limpieza iniciada para products, shape original: (32951, 9)
[2025-11-26T20:10:32.307936Z] products: duplicados eliminados, 32951 filas restantes
[2025-11-26T20:10:32.314953Z] products: columnas de texto normalizadas -> ['product_id', 'product_category_name']
[2025-11-26T20:10:32.322028Z] products: nulos tratados para todas las columnas
[2025-11-26T20:10:32.323013Z] Limpieza completada para products, shape final: (32951, 9)
[2025-11-26T20:10:32.324013Z] Limpieza iniciada para sellers, shape original: (3095, 4)
[2025-11-26T20:10:32.325015Z] sellers: duplicados eliminados, 3095 filas restantes
[2025-11-26T20:10:32.327445Z] sellers: columnas de texto normalizadas -> ['seller_id', 'seller_city', 'seller_state']
[2025-11-26T20:10:32.329745Z] sellers: nulos tratados para todas las columnas
[2025-11-26T20:10:32.329745Z] Limpieza completada para sellers, shape final: (3095, 4)
[2025-11-26T20:10:32.329745Z] Limpieza iniciada para category_translation, shape original: (71, 2)
[2025-11-26T20:10:32.330755Z] category_translation: duplicados eliminados, 71 filas restantes
[2025-11-26T20:10:32.332054Z] category_translation: columnas de texto normalizadas -> ['product_category_name', 'product_category_name_english']
[2025-11-26T20:10:32.332054Z] category_translation: nulos tratados para todas las columnas
[2025-11-26T20:10:32.333072Z] Limpieza completada para category_translation, shape final: (71, 2)
[2025-11-26T20:10:32.333072Z] === FIN Limpieza de tablas ===
[2025-11-26T20:10:32.333072Z] ======================================= FEATURE ENGINEERING =================================
[2025-11-26T20:10:32.334314Z] === INICIO Feature Engineering Avanzado ===
[2025-11-26T20:10:32.334314Z] Cargando tablas base...
[2025-11-26T20:10:32.334817Z] Realizando merge global...
[2025-11-26T20:10:32.857080Z] Dataset base creado con shape (119143, 39)
[2025-11-26T20:10:32.858501Z] Procesando variables temporales...
[2025-11-26T20:10:33.089369Z] Generando features por producto...
[2025-11-26T20:10:35.209777Z] Generando features del vendedor...
[2025-11-26T20:10:35.292605Z] Generando features de pago...
[2025-11-26T20:10:35.458498Z] Generando features agregados por cliente...
[2025-11-26T20:10:43.855582Z] Generando features temporales por ventana...
[2025-11-26T20:10:44.251718Z] Generando features avanzados (polinomiales y ratios)...
[2025-11-26T20:10:44.261528Z] Total features generados: 42
[2025-11-26T20:10:44.262033Z] Entrenando modelo para selección de features...
[2025-11-26T20:11:22.357077Z] Shape final de feature table: (99441, 32)
[2025-11-26T20:11:22.358059Z] === FIN Feature Engineering Avanzado ===
[2025-11-26T20:11:22.377606Z] === INICIO Feature Engineering Avanzado ===
[2025-11-26T20:11:22.377606Z] Cargando tablas base...
[2025-11-26T20:11:22.378614Z] Realizando merge global...
[2025-11-26T20:11:22.914708Z] Dataset base creado con shape (119143, 39)
[2025-11-26T20:11:22.915713Z] Procesando variables temporales...
[2025-11-26T20:11:23.122554Z] Generando features por producto...
[2025-11-26T20:11:25.242869Z] Generando features del vendedor...
[2025-11-26T20:11:25.313575Z] Generando features de pago...
[2025-11-26T20:11:25.445110Z] Generando features agregados por cliente...
[2025-11-26T20:11:34.296090Z] Generando features temporales por ventana...
[2025-11-26T20:11:34.685915Z] Generando features avanzados (polinomiales y ratios)...
[2025-11-26T20:11:34.694917Z] Total features generados: 42
[2025-11-26T20:11:34.695419Z] Entrenando modelo para selección de features...
[2025-11-26T20:12:16.056874Z] Shape final de feature table: (99441, 32)
[2025-11-26T20:12:16.057808Z] === FIN Feature Engineering Avanzado ===
[2025-11-26T20:12:16.082317Z] ======================================= LIMPIEZA FEATURES =================================
[2025-11-26T20:12:16.083273Z] === INICIO Limpieza de features ===
[2025-11-26T20:12:16.113955Z] customer_id: nulos rellenados con 'unknown'
[2025-11-26T20:12:16.117461Z] log_cust_review_mean: nulos rellenados con mediana=1.791759469228055
[2025-11-26T20:12:16.119462Z] cust_review_std: nulos rellenados con mediana=0.0
[2025-11-26T20:12:16.122464Z] quarter_neutral: nulos rellenados con mediana=0.0
[2025-11-26T20:12:16.125982Z] semester_neutral: nulos rellenados con mediana=0.0
[2025-11-26T20:12:16.128004Z] month_neutral: nulos rellenados con mediana=0.0
[2025-11-26T20:12:16.130959Z] cust_avg_price_x_cust_installments_mean: nulos rellenados con mediana=138.0
[2025-11-26T20:12:16.134008Z] cust_avg_freight: nulos rellenados con mediana=16.36
[2025-11-26T20:12:16.137038Z] cust_avg_price: nulos rellenados con mediana=79.0
[2025-11-26T20:12:16.139035Z] cust_avg_freight_x_cust_avg_delivery: nulos rellenados con mediana=170.10000000000002
[2025-11-26T20:12:16.141036Z] cust_total_spent: nulos rellenados con mediana=89.0
[2025-11-26T20:12:16.143029Z] cust_avg_freight_x_cust_installments_mean: nulos rellenados con mediana=28.88
[2025-11-26T20:12:16.145782Z] cust_total_spent_x_cust_installments_mean: nulos rellenados con mediana=150.0
[2025-11-26T20:12:16.253567Z] last_review_date: nulos rellenados con 'unknown'
[2025-11-26T20:12:16.258089Z] cust_avg_month: nulos rellenados con mediana=6.0
[2025-11-26T20:12:16.260082Z] log_cust_total_spent: nulos rellenados con mediana=4.499809670330265
[2025-11-26T20:12:16.261479Z] quarter_satisfecho: nulos rellenados con mediana=1.0
[2025-11-26T20:12:16.263482Z] cust_late_ratio: nulos rellenados con mediana=0.0
[2025-11-26T20:12:16.266183Z] cust_num_good_reviews: nulos rellenados con mediana=1.0
[2025-11-26T20:12:16.268189Z] cust_payment_methods: nulos rellenados con mediana=1.0
[2025-11-26T20:12:16.270185Z] cust_num_products: nulos rellenados con mediana=1.0
[2025-11-26T20:12:16.273190Z] cust_avg_freight_x_cust_late_ratio: nulos rellenados con mediana=0.0
[2025-11-26T20:12:16.274181Z] cust_total_spent_x_cust_late_ratio: nulos rellenados con mediana=0.0
[2025-11-26T20:12:16.276423Z] cust_payment_total: nulos rellenados con mediana=110.24
[2025-11-26T20:12:16.278432Z] month_satisfecho: nulos rellenados con mediana=1.0
[2025-11-26T20:12:16.281333Z] cust_avg_price_x_cust_avg_delivery: nulos rellenados con mediana=749.85
[2025-11-26T20:12:16.283613Z] cust_num_bad_reviews: nulos rellenados con mediana=0.0
[2025-11-26T20:12:16.286128Z] cust_total_orders: nulos rellenados con mediana=1.0
[2025-11-26T20:12:16.290135Z] log_cust_avg_delivery: nulos rellenados con mediana=2.3978952727983707
[2025-11-26T20:12:16.293981Z] cust_avg_weekday: nulos rellenados con mediana=3.0
[2025-11-26T20:12:16.297026Z] cust_avg_delivery: nulos rellenados con mediana=10.0
[2025-11-26T20:12:16.300021Z] cust_review_mean: nulos rellenados con mediana=5.0
[2025-11-26T20:12:16.301019Z] === FIN Limpieza de features ===
[2025-11-26T20:12:16.301019Z] ======================================= MASTER TABLE =================================
[2025-11-26T20:12:16.331764Z] ======================================= EXPORTACION DE MASTER TABLE =================================
[2025-11-26T20:12:18.262811Z] Master table creada con 99441 filas y 32 columnas
[2025-11-26T20:12:18.263747Z] ======================================= PREPROCESO MASTER TABLE =================================
[2025-11-26T20:12:18.566198Z] ======================================= CALCULO DE METRICAS =================================
[2025-11-26T20:12:18.567244Z] === INICIO Cálculo de métricas de satisfacción ===
[2025-11-26T20:12:18.574139Z] === FIN Cálculo de métricas de satisfacción ===
[2025-11-26T20:12:18.575168Z] ======================================= ENTRENAMIENTO DEL MODELO =================================
[2025-11-26T20:12:18.575762Z] Entrenando modelo de predicción de satisfacción...

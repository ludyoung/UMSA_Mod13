[2025-11-19T21:34:14.097428Z] === INICIO PIPELINE ===
[2025-11-19T21:34:15.102793Z] Tablas cargadas exitosamente: {'customers': 99441, 'geolocation': 1000163, 'order_items': 112650, 'payments': 103886, 'reviews': 99224, 'orders': 99441, 'products': 32951, 'sellers': 3095, 'category_translation': 71}
[2025-11-19T21:34:15.102793Z] === INICIO Limpieza de tablas ===
[2025-11-19T21:34:15.102793Z] Limpieza iniciada para customers, shape original: (99441, 5)
[2025-11-19T21:34:15.135981Z] customers: duplicados eliminados, 99441 filas restantes
[2025-11-19T21:34:15.178331Z] customers: columnas de texto normalizadas -> ['customer_id', 'customer_unique_id', 'customer_city', 'customer_state']
[2025-11-19T21:34:15.197162Z] customers: nulos tratados para todas las columnas
[2025-11-19T21:34:15.198161Z] Limpieza completada para customers, shape final: (99441, 5)
[2025-11-19T21:34:15.198161Z] Limpieza iniciada para geolocation, shape original: (1000163, 5)
[2025-11-19T21:34:15.427243Z] geolocation: duplicados eliminados, 738332 filas restantes
[2025-11-19T21:34:15.559541Z] geolocation: columnas de texto normalizadas -> ['geolocation_city', 'geolocation_state']
[2025-11-19T21:34:15.646517Z] geolocation: nulos tratados para todas las columnas
[2025-11-19T21:34:15.646517Z] Limpieza completada para geolocation, shape final: (738332, 5)
[2025-11-19T21:34:15.647522Z] Limpieza iniciada para order_items, shape original: (112650, 7)
[2025-11-19T21:34:15.695047Z] order_items: duplicados eliminados, 112650 filas restantes
[2025-11-19T21:34:15.743915Z] order_items: columnas de texto normalizadas -> ['order_id', 'product_id', 'seller_id', 'shipping_limit_date']
[2025-11-19T21:34:15.777463Z] order_items: columnas de fecha convertidas -> ['shipping_limit_date']
[2025-11-19T21:34:15.793640Z] order_items: nulos tratados para todas las columnas
[2025-11-19T21:34:15.793640Z] Limpieza completada para order_items, shape final: (112650, 7)
[2025-11-19T21:34:15.793640Z] Limpieza iniciada para payments, shape original: (103886, 5)
[2025-11-19T21:34:15.821616Z] payments: duplicados eliminados, 103886 filas restantes
[2025-11-19T21:34:15.844805Z] payments: columnas de texto normalizadas -> ['order_id', 'payment_type']
[2025-11-19T21:34:15.866436Z] payments: nulos tratados para todas las columnas
[2025-11-19T21:34:15.867463Z] Limpieza completada para payments, shape final: (103886, 5)
[2025-11-19T21:34:15.867463Z] Limpieza iniciada para reviews, shape original: (99224, 7)
[2025-11-19T21:34:15.932766Z] reviews: duplicados eliminados, 99224 filas restantes
[2025-11-19T21:34:16.006948Z] reviews: columnas de texto normalizadas -> ['review_id', 'order_id', 'review_comment_title', 'review_comment_message', 'review_creation_date', 'review_answer_timestamp']
[2025-11-19T21:34:16.039005Z] reviews: columnas de fecha convertidas -> ['review_creation_date', 'review_answer_timestamp']
[2025-11-19T21:34:16.060150Z] reviews: nulos tratados para todas las columnas
[2025-11-19T21:34:16.060150Z] Limpieza completada para reviews, shape final: (99224, 7)
[2025-11-19T21:34:16.061164Z] Limpieza iniciada para orders, shape original: (99441, 8)
[2025-11-19T21:34:16.137903Z] orders: duplicados eliminados, 99441 filas restantes
[2025-11-19T21:34:16.253568Z] orders: columnas de texto normalizadas -> ['order_id', 'customer_id', 'order_status', 'order_purchase_timestamp', 'order_approved_at', 'order_delivered_carrier_date', 'order_delivered_customer_date', 'order_estimated_delivery_date']
[2025-11-19T21:34:16.330169Z] orders: columnas de fecha convertidas -> ['order_purchase_timestamp', 'order_delivered_carrier_date', 'order_delivered_customer_date', 'order_estimated_delivery_date']
[2025-11-19T21:34:16.489067Z] orders: nulos tratados para todas las columnas
[2025-11-19T21:34:16.489709Z] Limpieza completada para orders, shape final: (99441, 8)
[2025-11-19T21:34:16.490037Z] Limpieza iniciada para products, shape original: (32951, 9)
[2025-11-19T21:34:16.502633Z] products: duplicados eliminados, 32951 filas restantes
[2025-11-19T21:34:16.512146Z] products: columnas de texto normalizadas -> ['product_id', 'product_category_name']
[2025-11-19T21:34:16.520047Z] products: nulos tratados para todas las columnas
[2025-11-19T21:34:16.520732Z] Limpieza completada para products, shape final: (32951, 9)
[2025-11-19T21:34:16.521260Z] Limpieza iniciada para sellers, shape original: (3095, 4)
[2025-11-19T21:34:16.522867Z] sellers: duplicados eliminados, 3095 filas restantes
[2025-11-19T21:34:16.524548Z] sellers: columnas de texto normalizadas -> ['seller_id', 'seller_city', 'seller_state']
[2025-11-19T21:34:16.525703Z] sellers: nulos tratados para todas las columnas
[2025-11-19T21:34:16.526029Z] Limpieza completada para sellers, shape final: (3095, 4)
[2025-11-19T21:34:16.526541Z] Limpieza iniciada para category_translation, shape original: (71, 2)
[2025-11-19T21:34:16.527614Z] category_translation: duplicados eliminados, 71 filas restantes
[2025-11-19T21:34:16.529497Z] category_translation: columnas de texto normalizadas -> ['product_category_name', 'product_category_name_english']
[2025-11-19T21:34:16.530053Z] category_translation: nulos tratados para todas las columnas
[2025-11-19T21:34:16.530561Z] Limpieza completada para category_translation, shape final: (71, 2)
[2025-11-19T21:34:16.530561Z] === FIN Limpieza de tablas ===
[2025-11-19T21:34:16.530561Z] === INICIO Feature Engineering Avanzado (modo C) ===
[2025-11-19T21:34:16.530561Z] Cargando tablas base...
[2025-11-19T21:34:16.618477Z] Agregando geolocation por zip prefix (evita explosion de joins)...
[2025-11-19T21:34:16.659044Z] Merged geolocation aggregated into customers
[2025-11-19T21:34:16.660052Z] Construyendo dataframe base de pedidos (orders + order_items)...
[2025-11-19T21:34:17.159147Z] Data merged shape (orders+items+...): (114092, 41)
[2025-11-19T21:34:17.159147Z] Procesando variables temporales por pedido...
[2025-11-19T21:34:17.324774Z] Construyendo agregaciones por producto y seller...
[2025-11-19T21:34:17.508996Z] Generando customer_features base (RFM, reviews, delivery, pagos)...
[2025-11-19T21:34:25.857011Z] customer_features base shape: (99441, 18)
[2025-11-19T21:34:25.857011Z] Generando features temporales (RFM, ventanas, tendencias)...
[2025-11-19T21:34:35.444142Z] Calculando tendencias mensuales (orders, review_score, delay) por cliente...
[2025-11-19T21:34:44.250560Z] Integrando features temporales y base en customer_features final...
[2025-11-19T21:34:44.450040Z] Generando features avanzados (interacciones, ratios, logs)...
[2025-11-19T21:34:44.460882Z] Generando features textuales: review comment lengths
[2025-11-19T21:34:55.566606Z] Total features finales antes de selección: 41
[2025-11-19T21:34:55.566606Z] Ejecutando selección automática con RandomForest...
[2025-11-19T21:34:55.566606Z] NaN en target cust_review_mean: 0
[2025-11-19T21:34:59.877769Z] Feature importances guardadas en: output\feature_importances.csv
[2025-11-19T21:34:59.878771Z] Top 30 variables más importantes:
[2025-11-19T21:34:59.878771Z]  - log_cust_review_mean: 0.996865
[2025-11-19T21:34:59.878771Z]  - pct_bad_reviews: 0.001076
[2025-11-19T21:34:59.879771Z]  - has_bad_reviews: 0.000940
[2025-11-19T21:34:59.879771Z]  - cust_num_bad_reviews: 0.000839
[2025-11-19T21:34:59.879771Z]  - cust_total_comment_chars: 0.000243
[2025-11-19T21:34:59.880772Z]  - cust_review_std: 0.000036
[2025-11-19T21:34:59.880772Z]  - log_cust_avg_delivery: 0.000000
[2025-11-19T21:34:59.881772Z]  - cust_payment_installments_mean_x_cust_avg_price: 0.000000
[2025-11-19T21:34:59.881772Z]  - cust_avg_freight: 0.000000
[2025-11-19T21:34:59.881772Z]  - cust_avg_carrier_delay: 0.000000
[2025-11-19T21:34:59.882771Z]  - cust_avg_price: 0.000000
[2025-11-19T21:34:59.882771Z]  - log_cust_total_spent: 0.000000
[2025-11-19T21:34:59.882771Z]  - cust_orders_last_3m: 0.000000
[2025-11-19T21:34:59.882771Z]  - cust_total_spent_x_cust_avg_delivery: 0.000000
[2025-11-19T21:34:59.882771Z]  - cust_monetary_monthly: 0.000000
[2025-11-19T21:34:59.884279Z]  - log_cust_total_items: 0.000000
[2025-11-19T21:34:59.884279Z]  - cust_recency_days: 0.000000
[2025-11-19T21:34:59.884279Z]  - cust_avg_approval_delay: 0.000000
[2025-11-19T21:34:59.885288Z]  - cust_unique_sellers: 0.000000
[2025-11-19T21:34:59.885288Z]  - cust_total_items: 0.000000
[2025-11-19T21:34:59.885288Z]  - cust_num_good_reviews: 0.000000
[2025-11-19T21:34:59.885288Z]  - cust_avg_price_x_cust_late_ratio: 0.000000
[2025-11-19T21:34:59.886287Z]  - ratio_good_bad_reviews: 0.000000
[2025-11-19T21:34:59.886287Z]  - cust_total_spent_x_cust_late_ratio: 0.000000
[2025-11-19T21:34:59.887286Z]  - cust_payment_installments_mean: 0.000000
[2025-11-19T21:34:59.887286Z]  - cust_payment_methods: 0.000000
[2025-11-19T21:34:59.887286Z]  - cust_avg_delivery: 0.000000
[2025-11-19T21:34:59.887286Z]  - cust_unique_products: 0.000000
[2025-11-19T21:34:59.888288Z]  - cust_orders_last_6m: 0.000000
[2025-11-19T21:34:59.888288Z]  - cust_avg_price_x_cust_avg_delivery: 0.000000
[2025-11-19T21:35:01.256507Z] Master table creada y guardada: output\master_table.csv
[2025-11-19T21:35:01.266188Z] Shape final master_table: (99441, 32)
[2025-11-19T21:35:01.266752Z] === FIN Feature Engineering Avanzado ===
[2025-11-19T21:35:01.298896Z] === INICIO Feature Engineering Avanzado (modo C) ===
[2025-11-19T21:35:01.298896Z] Cargando tablas base...
[2025-11-19T21:35:01.368585Z] Agregando geolocation por zip prefix (evita explosion de joins)...
[2025-11-19T21:35:01.399234Z] Merged geolocation aggregated into customers
[2025-11-19T21:35:01.400234Z] Construyendo dataframe base de pedidos (orders + order_items)...
[2025-11-19T21:35:01.883365Z] Data merged shape (orders+items+...): (114092, 41)
[2025-11-19T21:35:01.883365Z] Procesando variables temporales por pedido...
[2025-11-19T21:35:02.137706Z] Construyendo agregaciones por producto y seller...
[2025-11-19T21:35:02.333932Z] Generando customer_features base (RFM, reviews, delivery, pagos)...
[2025-11-19T21:35:11.059948Z] customer_features base shape: (99441, 18)
[2025-11-19T21:35:11.059948Z] Generando features temporales (RFM, ventanas, tendencias)...
[2025-11-19T21:35:20.939914Z] Calculando tendencias mensuales (orders, review_score, delay) por cliente...
[2025-11-19T21:35:30.207436Z] Integrando features temporales y base en customer_features final...
[2025-11-19T21:35:30.383938Z] Generando features avanzados (interacciones, ratios, logs)...
[2025-11-19T21:35:30.401264Z] Generando features textuales: review comment lengths
[2025-11-19T21:35:41.845775Z] Total features finales antes de selección: 41
[2025-11-19T21:35:41.845775Z] Ejecutando selección automática con RandomForest...
[2025-11-19T21:35:41.845775Z] NaN en target cust_review_mean: 0
[2025-11-19T21:35:45.962916Z] Feature importances guardadas en: output\feature_importances.csv
[2025-11-19T21:35:45.963916Z] Top 30 variables más importantes:
[2025-11-19T21:35:45.964912Z]  - log_cust_review_mean: 0.996865
[2025-11-19T21:35:45.966070Z]  - pct_bad_reviews: 0.001076
[2025-11-19T21:35:45.967125Z]  - has_bad_reviews: 0.000940
[2025-11-19T21:35:45.967125Z]  - cust_num_bad_reviews: 0.000839
[2025-11-19T21:35:45.968193Z]  - cust_total_comment_chars: 0.000243
[2025-11-19T21:35:45.968193Z]  - cust_review_std: 0.000036
[2025-11-19T21:35:45.968193Z]  - log_cust_avg_delivery: 0.000000
[2025-11-19T21:35:45.968193Z]  - cust_payment_installments_mean_x_cust_avg_price: 0.000000
[2025-11-19T21:35:45.969748Z]  - cust_avg_freight: 0.000000
[2025-11-19T21:35:45.969748Z]  - cust_avg_carrier_delay: 0.000000
[2025-11-19T21:35:45.970756Z]  - cust_avg_price: 0.000000
[2025-11-19T21:35:45.970756Z]  - log_cust_total_spent: 0.000000
[2025-11-19T21:35:45.970756Z]  - cust_orders_last_3m: 0.000000
[2025-11-19T21:35:45.971755Z]  - cust_total_spent_x_cust_avg_delivery: 0.000000
[2025-11-19T21:35:45.971755Z]  - cust_monetary_monthly: 0.000000
[2025-11-19T21:35:45.971755Z]  - log_cust_total_items: 0.000000
[2025-11-19T21:35:45.972756Z]  - cust_recency_days: 0.000000
[2025-11-19T21:35:45.972756Z]  - cust_avg_approval_delay: 0.000000
[2025-11-19T21:35:45.972756Z]  - cust_unique_sellers: 0.000000
[2025-11-19T21:35:45.972756Z]  - cust_total_items: 0.000000
[2025-11-19T21:35:45.973770Z]  - cust_num_good_reviews: 0.000000
[2025-11-19T21:35:45.973770Z]  - cust_avg_price_x_cust_late_ratio: 0.000000
[2025-11-19T21:35:45.974756Z]  - ratio_good_bad_reviews: 0.000000
[2025-11-19T21:35:45.974756Z]  - cust_total_spent_x_cust_late_ratio: 0.000000
[2025-11-19T21:35:45.974756Z]  - cust_payment_installments_mean: 0.000000
[2025-11-19T21:35:45.976042Z]  - cust_payment_methods: 0.000000
[2025-11-19T21:35:45.976042Z]  - cust_avg_delivery: 0.000000
[2025-11-19T21:35:45.977050Z]  - cust_unique_products: 0.000000
[2025-11-19T21:35:45.977050Z]  - cust_orders_last_6m: 0.000000
[2025-11-19T21:35:45.977050Z]  - cust_avg_price_x_cust_avg_delivery: 0.000000
[2025-11-19T21:35:47.252226Z] Master table creada y guardada: output\master_table.csv
[2025-11-19T21:35:47.252226Z] Shape final master_table: (99441, 32)
[2025-11-19T21:35:47.252226Z] === FIN Feature Engineering Avanzado ===
[2025-11-19T21:35:47.283921Z] === INICIO Limpieza de features ===
[2025-11-19T21:35:47.315563Z] customer_id: nulos rellenados con 'unknown'
[2025-11-19T21:35:47.317619Z] log_cust_review_mean: nulos rellenados con mediana=1.791759469228055
[2025-11-19T21:35:47.319625Z] pct_bad_reviews: nulos rellenados con mediana=0.0
[2025-11-19T21:35:47.319625Z] has_bad_reviews: nulos rellenados con mediana=0.0
[2025-11-19T21:35:47.319625Z] cust_num_bad_reviews: nulos rellenados con mediana=0.0
[2025-11-19T21:35:47.319625Z] cust_total_comment_chars: nulos rellenados con mediana=3.0
[2025-11-19T21:35:47.326032Z] cust_review_std: nulos rellenados con mediana=0.0
[2025-11-19T21:35:47.326032Z] log_cust_avg_delivery: nulos rellenados con mediana=2.3978952727983707
[2025-11-19T21:35:47.328586Z] cust_payment_installments_mean_x_cust_avg_price: nulos rellenados con mediana=139.8
[2025-11-19T21:35:47.330346Z] cust_avg_freight: nulos rellenados con mediana=16.32
[2025-11-19T21:35:47.330346Z] cust_avg_carrier_delay: nulos rellenados con mediana=42.588055555555556
[2025-11-19T21:35:47.330346Z] cust_avg_price: nulos rellenados con mediana=78.99
[2025-11-19T21:35:47.330346Z] log_cust_total_spent: nulos rellenados con mediana=4.711690029365764
[2025-11-19T21:35:47.336338Z] cust_orders_last_3m: nulos rellenados con mediana=0.0
[2025-11-19T21:35:47.336338Z] cust_total_spent_x_cust_avg_delivery: nulos rellenados con mediana=1051.68
[2025-11-19T21:35:47.336338Z] cust_monetary_monthly: nulos rellenados con mediana=110.24
[2025-11-19T21:35:47.336338Z] log_cust_total_items: nulos rellenados con mediana=0.6931471805599453
[2025-11-19T21:35:47.336338Z] cust_recency_days: nulos rellenados con mediana=271.0
[2025-11-19T21:35:47.336338Z] cust_avg_approval_delay: nulos rellenados con mediana=0.3425
[2025-11-19T21:35:47.336338Z] cust_unique_sellers: nulos rellenados con mediana=1.0
[2025-11-19T21:35:47.345820Z] cust_total_items: nulos rellenados con mediana=1.0
[2025-11-19T21:35:47.347779Z] cust_num_good_reviews: nulos rellenados con mediana=1.0
[2025-11-19T21:35:47.347779Z] cust_avg_price_x_cust_late_ratio: nulos rellenados con mediana=0.0
[2025-11-19T21:35:47.347779Z] ratio_good_bad_reviews: nulos rellenados con mediana=1.0
[2025-11-19T21:35:47.347779Z] cust_total_spent_x_cust_late_ratio: nulos rellenados con mediana=0.0
[2025-11-19T21:35:47.347779Z] cust_payment_installments_mean: nulos rellenados con mediana=2.0
[2025-11-19T21:35:47.347779Z] cust_payment_methods: nulos rellenados con mediana=1.0
[2025-11-19T21:35:47.357067Z] cust_avg_delivery: nulos rellenados con mediana=10.0
[2025-11-19T21:35:47.357067Z] cust_unique_products: nulos rellenados con mediana=1.0
[2025-11-19T21:35:47.357067Z] cust_orders_last_6m: nulos rellenados con mediana=0.0
[2025-11-19T21:35:47.357067Z] cust_avg_price_x_cust_avg_delivery: nulos rellenados con mediana=718.1999999999999
[2025-11-19T21:35:47.363502Z] cust_review_mean: nulos rellenados con mediana=5.0
[2025-11-19T21:35:47.363502Z] === FIN Limpieza de features ===
[2025-11-19T21:35:47.364388Z] Creando master table...
[2025-11-19T21:35:48.692652Z] Master table creada con 99441 filas y 32 columnas
[2025-11-19T21:35:48.933171Z] === INICIO Cálculo de métricas de satisfacción ===
[2025-11-19T21:35:48.939036Z] === FIN Cálculo de métricas de satisfacción ===
[2025-11-19T21:35:48.939036Z] Features generados:
[2025-11-19T21:35:48.956033Z] === PIPELINE FINALIZADO ===

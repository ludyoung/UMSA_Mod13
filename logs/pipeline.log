[2025-11-19T02:01:43.959454Z] === INICIO PIPELINE ===
[2025-11-19T02:01:46.210415Z] Tablas cargadas exitosamente: {'customers': 99441, 'geolocation': 1000163, 'order_items': 112650, 'payments': 103886, 'reviews': 99224, 'orders': 99441, 'products': 32951, 'sellers': 3095, 'category_translation': 71}
[2025-11-19T02:01:46.210925Z] === INICIO Limpieza de tablas ===
[2025-11-19T02:01:46.212954Z] Limpieza iniciada para customers, shape original: (99441, 5)
[2025-11-19T02:01:46.300689Z] customers: duplicados eliminados, 99441 filas restantes
[2025-11-19T02:01:46.394737Z] customers: columnas de texto normalizadas -> ['customer_id', 'customer_unique_id', 'customer_city', 'customer_state']
[2025-11-19T02:01:46.435078Z] customers: nulos tratados para todas las columnas
[2025-11-19T02:01:46.435078Z] Limpieza completada para customers, shape final: (99441, 5)
[2025-11-19T02:01:46.436895Z] Limpieza iniciada para geolocation, shape original: (1000163, 5)
[2025-11-19T02:01:46.961810Z] geolocation: duplicados eliminados, 738332 filas restantes
[2025-11-19T02:01:47.270224Z] geolocation: columnas de texto normalizadas -> ['geolocation_city', 'geolocation_state']
[2025-11-19T02:01:47.424289Z] geolocation: nulos tratados para todas las columnas
[2025-11-19T02:01:47.425832Z] Limpieza completada para geolocation, shape final: (738332, 5)
[2025-11-19T02:01:47.425832Z] Limpieza iniciada para order_items, shape original: (112650, 7)
[2025-11-19T02:01:47.531413Z] order_items: duplicados eliminados, 112650 filas restantes
[2025-11-19T02:01:47.657017Z] order_items: columnas de texto normalizadas -> ['order_id', 'product_id', 'seller_id', 'shipping_limit_date']
[2025-11-19T02:01:47.728348Z] order_items: columnas de fecha convertidas -> ['shipping_limit_date']
[2025-11-19T02:01:47.765588Z] order_items: nulos tratados para todas las columnas
[2025-11-19T02:01:47.769757Z] Limpieza completada para order_items, shape final: (112650, 7)
[2025-11-19T02:01:47.769757Z] Limpieza iniciada para payments, shape original: (103886, 5)
[2025-11-19T02:01:47.813301Z] payments: duplicados eliminados, 103886 filas restantes
[2025-11-19T02:01:47.861688Z] payments: columnas de texto normalizadas -> ['order_id', 'payment_type']
[2025-11-19T02:01:47.886705Z] payments: nulos tratados para todas las columnas
[2025-11-19T02:01:47.890427Z] Limpieza completada para payments, shape final: (103886, 5)
[2025-11-19T02:01:47.891498Z] Limpieza iniciada para reviews, shape original: (99224, 7)
[2025-11-19T02:01:47.998262Z] reviews: duplicados eliminados, 99224 filas restantes
[2025-11-19T02:01:48.187366Z] reviews: columnas de texto normalizadas -> ['review_id', 'order_id', 'review_comment_title', 'review_comment_message', 'review_creation_date', 'review_answer_timestamp']
[2025-11-19T02:01:48.247296Z] reviews: columnas de fecha convertidas -> ['review_creation_date', 'review_answer_timestamp']
[2025-11-19T02:01:48.285102Z] reviews: nulos tratados para todas las columnas
[2025-11-19T02:01:48.287697Z] Limpieza completada para reviews, shape final: (99224, 7)
[2025-11-19T02:01:48.288704Z] Limpieza iniciada para orders, shape original: (99441, 8)
[2025-11-19T02:01:48.465634Z] orders: duplicados eliminados, 99441 filas restantes
[2025-11-19T02:01:48.660732Z] orders: columnas de texto normalizadas -> ['order_id', 'customer_id', 'order_status', 'order_purchase_timestamp', 'order_approved_at', 'order_delivered_carrier_date', 'order_delivered_customer_date', 'order_estimated_delivery_date']
[2025-11-19T02:01:48.831752Z] orders: columnas de fecha convertidas -> ['order_purchase_timestamp', 'order_delivered_carrier_date', 'order_delivered_customer_date', 'order_estimated_delivery_date']
[2025-11-19T02:01:49.120320Z] orders: nulos tratados para todas las columnas
[2025-11-19T02:01:49.122329Z] Limpieza completada para orders, shape final: (99441, 8)
[2025-11-19T02:01:49.122329Z] Limpieza iniciada para products, shape original: (32951, 9)
[2025-11-19T02:01:49.139984Z] products: duplicados eliminados, 32951 filas restantes
[2025-11-19T02:01:49.150745Z] products: columnas de texto normalizadas -> ['product_id', 'product_category_name']
[2025-11-19T02:01:49.165253Z] products: nulos tratados para todas las columnas
[2025-11-19T02:01:49.165253Z] Limpieza completada para products, shape final: (32951, 9)
[2025-11-19T02:01:49.165253Z] Limpieza iniciada para sellers, shape original: (3095, 4)
[2025-11-19T02:01:49.165253Z] sellers: duplicados eliminados, 3095 filas restantes
[2025-11-19T02:01:49.175556Z] sellers: columnas de texto normalizadas -> ['seller_id', 'seller_city', 'seller_state']
[2025-11-19T02:01:49.178736Z] sellers: nulos tratados para todas las columnas
[2025-11-19T02:01:49.179749Z] Limpieza completada para sellers, shape final: (3095, 4)
[2025-11-19T02:01:49.180747Z] Limpieza iniciada para category_translation, shape original: (71, 2)
[2025-11-19T02:01:49.182762Z] category_translation: duplicados eliminados, 71 filas restantes
[2025-11-19T02:01:49.184772Z] category_translation: columnas de texto normalizadas -> ['product_category_name', 'product_category_name_english']
[2025-11-19T02:01:49.186781Z] category_translation: nulos tratados para todas las columnas
[2025-11-19T02:01:49.186781Z] Limpieza completada para category_translation, shape final: (71, 2)
[2025-11-19T02:01:49.188312Z] === FIN Limpieza de tablas ===
[2025-11-19T02:01:49.188312Z] === INICIO Feature Engineering ===
[2025-11-19T02:01:49.188312Z] Cargando tablas base para features...
[2025-11-19T02:01:49.190325Z] Tablas cargadas: orders, order_items, reviews, products, sellers, payments, customers, geolocation, category_translation
[2025-11-19T02:01:49.190325Z] Realizando merge de tablas para construir dataset base...
[2025-11-19T02:01:50.142246Z] Merged dataset shape: (119143, 39)
[2025-11-19T02:01:50.145638Z] Creando features de tiempo y retraso de entrega...
[2025-11-19T02:01:50.492098Z] Features de tiempo generados: delivery_time_days, estimated_delay_days, was_late, order_month, order_quarter, order_semester
[2025-11-19T02:01:50.492098Z] Agregando features por customer_id...
[2025-11-19T02:02:08.613043Z] Features generados por cliente: ['customer_id', 'cust_total_orders', 'cust_total_spent', 'cust_avg_price', 'cust_avg_freight', 'cust_num_products', 'cust_review_mean', 'cust_review_std', 'cust_num_bad_reviews', 'cust_num_good_reviews', 'cust_avg_delivery', 'cust_late_ratio', 'cust_avg_order_month', 'cust_avg_order_quarter', 'cust_avg_order_semester']
[2025-11-19T02:02:08.615055Z] === FIN Feature Engineering ===
[2025-11-19T02:02:08.633609Z] === INICIO Feature Engineering ===
[2025-11-19T02:02:08.637310Z] Cargando tablas base para features...
[2025-11-19T02:02:08.637310Z] Tablas cargadas: orders, order_items, reviews, products, sellers, payments, customers, geolocation, category_translation
[2025-11-19T02:02:08.639538Z] Realizando merge de tablas para construir dataset base...
[2025-11-19T02:02:09.609448Z] Merged dataset shape: (119143, 39)
[2025-11-19T02:02:09.609448Z] Creando features de tiempo y retraso de entrega...
[2025-11-19T02:02:09.943155Z] Features de tiempo generados: delivery_time_days, estimated_delay_days, was_late, order_month, order_quarter, order_semester
[2025-11-19T02:02:09.943155Z] Agregando features por customer_id...
[2025-11-19T02:02:28.407323Z] Features generados por cliente: ['customer_id', 'cust_total_orders', 'cust_total_spent', 'cust_avg_price', 'cust_avg_freight', 'cust_num_products', 'cust_review_mean', 'cust_review_std', 'cust_num_bad_reviews', 'cust_num_good_reviews', 'cust_avg_delivery', 'cust_late_ratio', 'cust_avg_order_month', 'cust_avg_order_quarter', 'cust_avg_order_semester']
[2025-11-19T02:02:28.409868Z] === FIN Feature Engineering ===
[2025-11-19T02:02:28.415986Z] === INICIO Limpieza de features ===
[2025-11-19T02:02:28.439407Z] customer_id: nulos rellenados con 'unknown'
[2025-11-19T02:02:28.439407Z] cust_total_orders: nulos rellenados con mediana=1.0
[2025-11-19T02:02:28.444506Z] cust_total_spent: nulos rellenados con mediana=89.0
[2025-11-19T02:02:28.448221Z] cust_avg_price: nulos rellenados con mediana=79.0
[2025-11-19T02:02:28.448221Z] cust_avg_freight: nulos rellenados con mediana=16.36
[2025-11-19T02:02:28.448221Z] cust_num_products: nulos rellenados con mediana=1.0
[2025-11-19T02:02:28.458550Z] cust_review_mean: nulos rellenados con mediana=5.0
[2025-11-19T02:02:28.461166Z] cust_review_std: nulos rellenados con mediana=0.0
[2025-11-19T02:02:28.465184Z] cust_num_bad_reviews: nulos rellenados con mediana=0.0
[2025-11-19T02:02:28.467442Z] cust_num_good_reviews: nulos rellenados con mediana=1.0
[2025-11-19T02:02:28.470982Z] cust_avg_delivery: nulos rellenados con mediana=10.0
[2025-11-19T02:02:28.470982Z] cust_late_ratio: nulos rellenados con mediana=0.0
[2025-11-19T02:02:28.476053Z] cust_avg_order_month: nulos rellenados con mediana=6.0
[2025-11-19T02:02:28.479904Z] cust_avg_order_quarter: nulos rellenados con mediana=2.0
[2025-11-19T02:02:28.479904Z] cust_avg_order_semester: nulos rellenados con mediana=1.0
[2025-11-19T02:02:28.479904Z] === FIN Limpieza de features ===
[2025-11-19T02:02:28.479904Z] Creando master table...
[2025-11-19T02:02:29.415585Z] Master table creada con 99441 filas y 15 columnas
[2025-11-19T02:02:29.707607Z] === INICIO Cálculo de métricas de satisfacción ===
[2025-11-19T02:02:29.729191Z] === FIN Cálculo de métricas de satisfacción ===
[2025-11-19T02:02:29.734653Z] Features generados:
[2025-11-19T02:02:29.771313Z] === PIPELINE FINALIZADO ===
